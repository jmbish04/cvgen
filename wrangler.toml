name = "cvgen-api"
main = "worker/src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# KV Namespaces for caching
[[kv_namespaces]]
binding = "CACHE"
id = "76402e4a1ad7471eb3995ee08ea22aa6"

# R2 Buckets for storing CV assets
[[r2_buckets]]
binding = "CV_ASSETS"
bucket_name = "cv-assets"

# D1 Database for request logging
[[d1_databases]]
binding = "DB"
database_name = "cvgen-db"
database_id = "https://github.com/cloudflare/vibesdk"
migrations_dir = "migrations" 

# Vectorize for CV content search
[[vectorize]]
binding = "VECTORIZE"
index_name = "cv-embeddings"

# AI Binding
[ai]
binding = "AI"

# Browser Rendering
[browser]
binding = "BROWSER"

# Durable Objects (if needed for chat sessions)
[[durable_objects.bindings]]
name = "CHAT_SESSION"
class_name = "ChatSession"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatSession"]

[build]
command = "npm run build"

[observability]
enabled = true
